function Subscribe(b){this.group=b;this.tpe="de.hawhamburg.csti.messaging.Subscribe"}function SubscribeAck(b){this.group=b;this.tpe="de.hawhamburg.csti.messaging.SubscribeAck"}function Unsubscribe(b){this.group=b;this.tpe="de.hawhamburg.csti.messaging.Unsubscribe"}function UnsubscribeAck(b){this.group=b;this.tpe="de.hawhamburg.csti.messaging.UnsubscribeAck"}function Publish(b,a){this.group=b;this.msg=a;this.tpe="de.hawhamburg.csti.messaging.Publish"}
var TunnelDeserializer=new function(){var b=function(a,b){var e={};Object.keys(a).forEach(function(d){var c=a[d];Array.isArray(c)?c=a[d].map(function(a){console.log(a);return"object"===typeof a?b.deserialize(a):a}):"object"===typeof c&&(c=b.deserialize(c));e[d]={writable:!1,configurable:!1,value:c}});return e};this.deserialize=function(a){if("de.hawhamburg.csti.messaging.Subscribe"===a.tpe)return this.deserializeSubscribe(a);if("de.hawhamburg.csti.messaging.SubscribeAck"===a.tpe)return this.deserializeSubscribeAck(a);
if("de.hawhamburg.csti.messaging.Unsubscribe"===a.tpe)return this.deserializeUnsubscribe(a);if("de.hawhamburg.csti.messaging.UnsubscribeAck"===a.tpe)return this.deserializeUnsubscribeAck(a);if("de.hawhamburg.csti.messaging.Publish"===a.tpe)return this.deserializePublish(a)};this.deserializeSubscribe=function(a){return Object.create(Subscribe.prototype,b(a,this))};this.deserializeSubscribeAck=function(a){return Object.create(SubscribeAck.prototype,b(a,this))};this.deserializeUnsubscribe=function(a){return Object.create(Unsubscribe.prototype,
b(a,this))};this.deserializeUnsubscribeAck=function(a){return Object.create(UnsubscribeAck.prototype,b(a,this))};this.deserializePublish=function(a){return Object.create(Publish.prototype,b(a,this))}};
function MiddlewareConnector(b){var a=!1,g=[],e=[],d=this;this.publish=function(b,f){if(a){var h=new Publish(b,JSON.stringify(f));c.send(JSON.stringify(h))}};this.subscribe=function(b,f,h){f={group:b,deser:f,callback:h};a?(e.push(f),b=new Subscribe(b),c.send(JSON.stringify(b))):g.push(f)};var c=new WebSocket(b);c.onmessage=function(a){a=JSON.parse(a.data);for(var b=0;b<e.length;b++){var c=e[b];if(c.group===a.group){var d=JSON.parse(a.msg);c.callback(c.deser.deserialize(d))}}};c.onopen=function(){a=
!0;for(var b=0;b<g.length;b++){var c=g[b];d.subscribe(c.group,c.deser,c.callback)}};c.onclose=function(){a&&console.error("connection lost");a=!1}};